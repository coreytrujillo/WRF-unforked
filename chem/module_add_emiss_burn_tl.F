!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.6 (r4756) - 12 Feb 2013 10:43
!
MODULE g_module_add_emiss_burn
  IMPLICIT NONE

CONTAINS
!  Differentiation of add_emis_burn in forward (tangent) mode (with options r8 noISIZE):
!   variations   of useful results: chem
!   with respect to varying inputs: scalebb rho_phy chem dz8w
  SUBROUTINE g_add_emis_burn(id, dtstep, ktau, dz8w, g_dz8w, rho_phy, &
&    g_rho_phy, chem, g_chem, julday, gmt, xlat, xlong, t_phy, p_phy, ebu&
&    , chem_opt, tracer_opt, biomass_burn_opt, scalebb, g_scalebb, &
&    scale_burn_opt, num_c, ids, ide, jds, jde, kds, kde, ims, ime, jms, &
&    jme, kms, kme, its, ite, jts, jte, kts, kte)
    USE module_configure, only: grid_config_rec_type
    USE module_state_description
    IMPLICIT NONE
    INTEGER, INTENT(IN) :: id, julday, chem_opt, biomass_burn_opt, num_c&
&    , ids, ide, jds, jde, kds, kde, ims, ime, jms, jme, kms, kme, its, &
&    ite, jts, jte, kts, kte, tracer_opt
    INTEGER, INTENT(IN) :: ktau
    REAL, DIMENSION(ims:ime, kms:kme, jms:jme, num_c), INTENT(INOUT) :: &
&    chem
    REAL, DIMENSION(ims:ime, kms:kme, jms:jme, num_c), INTENT(INOUT) :: &
&    g_chem
    REAL, DIMENSION(ims:ime, kms:kme, jms:jme, num_ebu), INTENT(IN) :: &
&    ebu
    REAL, DIMENSION(ims:ime, jms:jme, num_scalebb), INTENT(IN) :: &
&    scalebb
    REAL, DIMENSION(ims:ime, jms:jme, num_scalebb), INTENT(IN) :: &
&    g_scalebb
    INTEGER, INTENT(IN) :: scale_burn_opt
    REAL, DIMENSION(ims:ime, jms:jme), INTENT(IN) :: xlat, xlong
    REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(IN) :: t_phy, &
&    p_phy, dz8w, rho_phy
    REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(IN) :: g_dz8w, &
&    g_rho_phy
    REAL, INTENT(IN) :: dtstep, gmt
    INTEGER :: imonth1, idate1, iyear1, itime1
    INTEGER :: i, j, k
    REAL :: time, conv_rho
    REAL :: g_conv_rho
    INTEGER :: iweek, idays
    REAL :: tign, timeq, r_q, r_antro
    REAL, DIMENSION(7) :: week_cycle
    REAL, PARAMETER :: bx_bburn=18.041288*3600., cx=2.184936*3600., &
&    rinti=2.1813936e-8, ax=2000.6038, bx_antro=15.041288*3600.
    REAL*8 :: arg1
    REAL :: arg10
    DATA (week_cycle(iweek), iweek=1,7) /0.67, 1.1, 1.1, 1.1, 1.1, 1.1, &
&         0.83/
    itime1 = 0
    time = 0.
    arg1 = (FLOAT(itime1)/100.+time/3600.)/24. + .00001
    idays = INT(arg1)
    tign = REAL(idays)*24.*3600.
    timeq = time + FLOAT(itime1)*0.01*3600. - tign
    timeq = gmt*3600. + FLOAT(ktau)*dtstep
    timeq = MOD(timeq, 86400.)
    arg10 = -((timeq-bx_bburn)**2/(2.*cx**2))
    r_q = rinti*(ax*EXP(arg10)+100.-5.6712963e-4*timeq)
    arg1 = (FLOAT(julday)/7.-INT(julday/7))*7.
    iweek = INT(arg1) + 1
    IF (iweek .GT. 7) iweek = iweek - 7
    r_q = r_q*86400.
    r_q = 1.
    SELECT CASE  (tracer_opt) 
    CASE (TRACER_SMOKE) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&              g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, &
&              j)*60.)
            g_chem(i, k, j, p_smoke) = g_chem(i, k, j, p_smoke) + ebu(i&
&              , k, j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+&
&              scalebb(i, j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_smoke) = chem(i, k, j, p_smoke) + ebu(i, k, &
&              j, p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
          END DO
        END DO
      END DO
    CASE (TRACER_TEST2) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&              g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, &
&              j)*60.)
            g_chem(i, k, j, p_tr17_3) = g_chem(i, k, j, p_tr17_3) + ebu(&
&              i, k, j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+&
&              scalebb(i, j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_tr17_3) = chem(i, k, j, p_tr17_3) + ebu(i, k&
&              , j, p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
            g_chem(i, k, j, p_tr17_4) = g_chem(i, k, j, p_tr17_4) + ebu(&
&              i, k, j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+&
&              scalebb(i, j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_tr17_4) = chem(i, k, j, p_tr17_4) + ebu(i, k&
&              , j, p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
          END DO
        END DO
      END DO
    CASE DEFAULT
      CALL WRF_DEBUG(15, &
&               'nothing done with burn emissions for tracers here')
    END SELECT
    SELECT CASE  (chem_opt) 
    CASE (RACMPM_KPP) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&              g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, &
&              j)*60.)
            g_chem(i, k, j, p_so2) = g_chem(i, k, j, p_so2) + ebu(i, k, &
&              j, p_ebu_so2)*(g_scalebb(i, j, p_scbb_so2)*conv_rho+&
&              scalebb(i, j, p_scbb_so2)*g_conv_rho)
            chem(i, k, j, p_so2) = chem(i, k, j, p_so2) + ebu(i, k, j, &
&              p_ebu_so2)*scalebb(i, j, p_scbb_so2)*conv_rho
            g_chem(i, k, j, p_sulf) = g_chem(i, k, j, p_sulf) + ebu(i, k&
&              , j, p_ebu_sulf)*(g_scalebb(i, j, p_scbb_sulf)*conv_rho+&
&              scalebb(i, j, p_scbb_sulf)*g_conv_rho)
            chem(i, k, j, p_sulf) = chem(i, k, j, p_sulf) + ebu(i, k, j&
&              , p_ebu_sulf)*scalebb(i, j, p_scbb_sulf)*conv_rho
            g_chem(i, k, j, p_csl) = g_chem(i, k, j, p_csl) + ebu(i, k, &
&              j, p_ebu_csl)*(g_scalebb(i, j, p_scbb_csl)*conv_rho+&
&              scalebb(i, j, p_scbb_csl)*g_conv_rho)
            chem(i, k, j, p_csl) = chem(i, k, j, p_csl) + ebu(i, k, j, &
&              p_ebu_csl)*scalebb(i, j, p_scbb_csl)*conv_rho
            g_chem(i, k, j, p_iso) = g_chem(i, k, j, p_iso) + ebu(i, k, &
&              j, p_ebu_iso)*(g_scalebb(i, j, p_scbb_iso)*conv_rho+&
&              scalebb(i, j, p_scbb_iso)*g_conv_rho)
            chem(i, k, j, p_iso) = chem(i, k, j, p_iso) + ebu(i, k, j, &
&              p_ebu_iso)*scalebb(i, j, p_scbb_iso)*conv_rho
            g_chem(i, k, j, p_no) = g_chem(i, k, j, p_no) + ebu(i, k, j&
&              , p_ebu_no)*(g_scalebb(i, j, p_scbb_no)*conv_rho+scalebb(i&
&              , j, p_scbb_no)*g_conv_rho)
            chem(i, k, j, p_no) = chem(i, k, j, p_no) + ebu(i, k, j, &
&              p_ebu_no)*scalebb(i, j, p_scbb_no)*conv_rho
            g_chem(i, k, j, p_no2) = g_chem(i, k, j, p_no2) + ebu(i, k, &
&              j, p_ebu_no2)*(g_scalebb(i, j, p_scbb_no2)*conv_rho+&
&              scalebb(i, j, p_scbb_no2)*g_conv_rho)
            chem(i, k, j, p_no2) = chem(i, k, j, p_no2) + ebu(i, k, j, &
&              p_ebu_no2)*scalebb(i, j, p_scbb_no2)*conv_rho
            g_chem(i, k, j, p_ald) = g_chem(i, k, j, p_ald) + ebu(i, k, &
&              j, p_ebu_ald)*(g_scalebb(i, j, p_scbb_ald)*conv_rho+&
&              scalebb(i, j, p_scbb_ald)*g_conv_rho)
            chem(i, k, j, p_ald) = chem(i, k, j, p_ald) + ebu(i, k, j, &
&              p_ebu_ald)*scalebb(i, j, p_scbb_ald)*conv_rho
            g_chem(i, k, j, p_hcho) = g_chem(i, k, j, p_hcho) + ebu(i, k&
&              , j, p_ebu_hcho)*(g_scalebb(i, j, p_scbb_hcho)*conv_rho+&
&              scalebb(i, j, p_scbb_hcho)*g_conv_rho)
            chem(i, k, j, p_hcho) = chem(i, k, j, p_hcho) + ebu(i, k, j&
&              , p_ebu_hcho)*scalebb(i, j, p_scbb_hcho)*conv_rho
            g_chem(i, k, j, p_ora2) = g_chem(i, k, j, p_ora2) + ebu(i, k&
&              , j, p_ebu_ora2)*(g_scalebb(i, j, p_scbb_ora2)*conv_rho+&
&              scalebb(i, j, p_scbb_ora2)*g_conv_rho)
            chem(i, k, j, p_ora2) = chem(i, k, j, p_ora2) + ebu(i, k, j&
&              , p_ebu_ora2)*scalebb(i, j, p_scbb_ora2)*conv_rho
            g_chem(i, k, j, p_hc3) = g_chem(i, k, j, p_hc3) + ebu(i, k, &
&              j, p_ebu_hc3)*(g_scalebb(i, j, p_scbb_hc3)*conv_rho+&
&              scalebb(i, j, p_scbb_hc3)*g_conv_rho)
            chem(i, k, j, p_hc3) = chem(i, k, j, p_hc3) + ebu(i, k, j, &
&              p_ebu_hc3)*scalebb(i, j, p_scbb_hc3)*conv_rho
            g_chem(i, k, j, p_hc5) = g_chem(i, k, j, p_hc5) + ebu(i, k, &
&              j, p_ebu_hc5)*(g_scalebb(i, j, p_scbb_hc5)*conv_rho+&
&              scalebb(i, j, p_scbb_hc5)*g_conv_rho)
            chem(i, k, j, p_hc5) = chem(i, k, j, p_hc5) + ebu(i, k, j, &
&              p_ebu_hc5)*scalebb(i, j, p_scbb_hc5)*conv_rho
            g_chem(i, k, j, p_hc8) = g_chem(i, k, j, p_hc8) + ebu(i, k, &
&              j, p_ebu_hc8)*(g_scalebb(i, j, p_scbb_hc8)*conv_rho+&
&              scalebb(i, j, p_scbb_hc8)*g_conv_rho)
            chem(i, k, j, p_hc8) = chem(i, k, j, p_hc8) + ebu(i, k, j, &
&              p_ebu_hc8)*scalebb(i, j, p_scbb_hc8)*conv_rho
            g_chem(i, k, j, p_eth) = g_chem(i, k, j, p_eth) + ebu(i, k, &
&              j, p_ebu_eth)*(g_scalebb(i, j, p_scbb_eth)*conv_rho+&
&              scalebb(i, j, p_scbb_eth)*g_conv_rho)
            chem(i, k, j, p_eth) = chem(i, k, j, p_eth) + ebu(i, k, j, &
&              p_ebu_eth)*scalebb(i, j, p_scbb_eth)*conv_rho
            g_chem(i, k, j, p_co) = g_chem(i, k, j, p_co) + ebu(i, k, j&
&              , p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+scalebb(i&
&              , j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_co) = chem(i, k, j, p_co) + ebu(i, k, j, &
&              p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
            g_chem(i, k, j, p_olt) = g_chem(i, k, j, p_olt) + ebu(i, k, &
&              j, p_ebu_olt)*(g_scalebb(i, j, p_scbb_olt)*conv_rho+&
&              scalebb(i, j, p_scbb_olt)*g_conv_rho)
            chem(i, k, j, p_olt) = chem(i, k, j, p_olt) + ebu(i, k, j, &
&              p_ebu_olt)*scalebb(i, j, p_scbb_olt)*conv_rho
            g_chem(i, k, j, p_oli) = g_chem(i, k, j, p_oli) + ebu(i, k, &
&              j, p_ebu_oli)*(g_scalebb(i, j, p_scbb_oli)*conv_rho+&
&              scalebb(i, j, p_scbb_oli)*g_conv_rho)
            chem(i, k, j, p_oli) = chem(i, k, j, p_oli) + ebu(i, k, j, &
&              p_ebu_oli)*scalebb(i, j, p_scbb_oli)*conv_rho
            g_chem(i, k, j, p_tol) = g_chem(i, k, j, p_tol) + ebu(i, k, &
&              j, p_ebu_tol)*(g_scalebb(i, j, p_scbb_tol)*conv_rho+&
&              scalebb(i, j, p_scbb_tol)*g_conv_rho)
            chem(i, k, j, p_tol) = chem(i, k, j, p_tol) + ebu(i, k, j, &
&              p_ebu_tol)*scalebb(i, j, p_scbb_tol)*conv_rho
            g_chem(i, k, j, p_xyl) = g_chem(i, k, j, p_xyl) + ebu(i, k, &
&              j, p_ebu_xyl)*(g_scalebb(i, j, p_scbb_xyl)*conv_rho+&
&              scalebb(i, j, p_scbb_xyl)*g_conv_rho)
            chem(i, k, j, p_xyl) = chem(i, k, j, p_xyl) + ebu(i, k, j, &
&              p_ebu_xyl)*scalebb(i, j, p_scbb_xyl)*conv_rho
            g_chem(i, k, j, p_ket) = g_chem(i, k, j, p_ket) + ebu(i, k, &
&              j, p_ebu_ket)*(g_scalebb(i, j, p_scbb_ket)*conv_rho+&
&              scalebb(i, j, p_scbb_ket)*g_conv_rho)
            chem(i, k, j, p_ket) = chem(i, k, j, p_ket) + ebu(i, k, j, &
&              p_ebu_ket)*scalebb(i, j, p_scbb_ket)*conv_rho
            g_chem(i, k, j, p_pm_25) = g_chem(i, k, j, p_pm_25) + (&
&              dtstep*(r_q*ebu(i, k, j, p_ebu_pm25)*g_scalebb(i, j, &
&              p_scbb_pm25)*rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_pm25)&
&              *scalebb(i, j, p_scbb_pm25)*g_rho_phy(i, k, j))*dz8w(i, k&
&              , j)/rho_phy(i, k, j)**2-r_q*ebu(i, k, j, p_ebu_pm25)*&
&              scalebb(i, j, p_scbb_pm25)*dtstep*g_dz8w(i, k, j)/rho_phy(&
&              i, k, j))/dz8w(i, k, j)**2
            chem(i, k, j, p_pm_25) = chem(i, k, j, p_pm_25) + r_q*ebu(i&
&              , k, j, p_ebu_pm25)*scalebb(i, j, p_scbb_pm25)/rho_phy(i, &
&              k, j)*dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_pm_10) = g_chem(i, k, j, p_pm_10) + (&
&              dtstep*(r_q*ebu(i, k, j, p_ebu_pm10)*g_scalebb(i, j, &
&              p_scbb_pm10)*rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_pm10)&
&              *scalebb(i, j, p_scbb_pm10)*g_rho_phy(i, k, j))*dz8w(i, k&
&              , j)/rho_phy(i, k, j)**2-r_q*ebu(i, k, j, p_ebu_pm10)*&
&              scalebb(i, j, p_scbb_pm10)*dtstep*g_dz8w(i, k, j)/rho_phy(&
&              i, k, j))/dz8w(i, k, j)**2
            chem(i, k, j, p_pm_10) = chem(i, k, j, p_pm_10) + r_q*ebu(i&
&              , k, j, p_ebu_pm10)*scalebb(i, j, p_scbb_pm10)/rho_phy(i, &
&              k, j)*dtstep/dz8w(i, k, j)
          END DO
        END DO
      END DO
    CASE (RADM2SORG, RACMSORG_KPP, RADM2SORG_KPP, RACM_ESRLSORG_KPP, &
&    racm_soa_vbs_kpp, radm2sorg_aq, radm2sorg_aqchem, racmsorg_aq, &
&    racmsorg_aqchem_kpp) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)/(rho_phy(i, k, j)**2*60.))-r_q*4.828e-4*dtstep*&
&              g_dz8w(i, k, j)/(rho_phy(i, k, j)*60.))/dz8w(i, k, j)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/60./dz8w(i, &
&              k, j)
            g_chem(i, k, j, p_so2) = g_chem(i, k, j, p_so2) + ebu(i, k, &
&              j, p_ebu_so2)*(g_scalebb(i, j, p_scbb_so2)*conv_rho+&
&              scalebb(i, j, p_scbb_so2)*g_conv_rho)
            chem(i, k, j, p_so2) = chem(i, k, j, p_so2) + ebu(i, k, j, &
&              p_ebu_so2)*scalebb(i, j, p_scbb_so2)*conv_rho
            g_chem(i, k, j, p_sulf) = g_chem(i, k, j, p_sulf) + ebu(i, k&
&              , j, p_ebu_sulf)*(g_scalebb(i, j, p_scbb_sulf)*conv_rho+&
&              scalebb(i, j, p_scbb_sulf)*g_conv_rho)
            chem(i, k, j, p_sulf) = chem(i, k, j, p_sulf) + ebu(i, k, j&
&              , p_ebu_sulf)*scalebb(i, j, p_scbb_sulf)*conv_rho
            g_chem(i, k, j, p_csl) = g_chem(i, k, j, p_csl) + ebu(i, k, &
&              j, p_ebu_csl)*(g_scalebb(i, j, p_scbb_csl)*conv_rho+&
&              scalebb(i, j, p_scbb_csl)*g_conv_rho)
            chem(i, k, j, p_csl) = chem(i, k, j, p_csl) + ebu(i, k, j, &
&              p_ebu_csl)*scalebb(i, j, p_scbb_csl)*conv_rho
            g_chem(i, k, j, p_iso) = g_chem(i, k, j, p_iso) + ebu(i, k, &
&              j, p_ebu_iso)*(g_scalebb(i, j, p_scbb_iso)*conv_rho+&
&              scalebb(i, j, p_scbb_iso)*g_conv_rho)
            chem(i, k, j, p_iso) = chem(i, k, j, p_iso) + ebu(i, k, j, &
&              p_ebu_iso)*scalebb(i, j, p_scbb_iso)*conv_rho
            g_chem(i, k, j, p_no) = g_chem(i, k, j, p_no) + ebu(i, k, j&
&              , p_ebu_no)*(g_scalebb(i, j, p_scbb_no)*conv_rho+scalebb(i&
&              , j, p_scbb_no)*g_conv_rho)
            chem(i, k, j, p_no) = chem(i, k, j, p_no) + ebu(i, k, j, &
&              p_ebu_no)*scalebb(i, j, p_scbb_no)*conv_rho
            g_chem(i, k, j, p_no2) = g_chem(i, k, j, p_no2) + ebu(i, k, &
&              j, p_ebu_no2)*(g_scalebb(i, j, p_scbb_no2)*conv_rho+&
&              scalebb(i, j, p_scbb_no2)*g_conv_rho)
            chem(i, k, j, p_no2) = chem(i, k, j, p_no2) + ebu(i, k, j, &
&              p_ebu_no2)*scalebb(i, j, p_scbb_no2)*conv_rho
            g_chem(i, k, j, p_ald) = g_chem(i, k, j, p_ald) + ebu(i, k, &
&              j, p_ebu_ald)*(g_scalebb(i, j, p_scbb_ald)*conv_rho+&
&              scalebb(i, j, p_scbb_ald)*g_conv_rho)
            chem(i, k, j, p_ald) = chem(i, k, j, p_ald) + ebu(i, k, j, &
&              p_ebu_ald)*scalebb(i, j, p_scbb_ald)*conv_rho
            g_chem(i, k, j, p_hcho) = g_chem(i, k, j, p_hcho) + ebu(i, k&
&              , j, p_ebu_hcho)*(g_scalebb(i, j, p_scbb_hcho)*conv_rho+&
&              scalebb(i, j, p_scbb_hcho)*g_conv_rho)
            chem(i, k, j, p_hcho) = chem(i, k, j, p_hcho) + ebu(i, k, j&
&              , p_ebu_hcho)*scalebb(i, j, p_scbb_hcho)*conv_rho
            g_chem(i, k, j, p_ora2) = g_chem(i, k, j, p_ora2) + ebu(i, k&
&              , j, p_ebu_ora2)*(g_scalebb(i, j, p_scbb_ora2)*conv_rho+&
&              scalebb(i, j, p_scbb_ora2)*g_conv_rho)
            chem(i, k, j, p_ora2) = chem(i, k, j, p_ora2) + ebu(i, k, j&
&              , p_ebu_ora2)*scalebb(i, j, p_scbb_ora2)*conv_rho
            g_chem(i, k, j, p_hc3) = g_chem(i, k, j, p_hc3) + ebu(i, k, &
&              j, p_ebu_hc3)*(g_scalebb(i, j, p_scbb_hc3)*conv_rho+&
&              scalebb(i, j, p_scbb_hc3)*g_conv_rho)
            chem(i, k, j, p_hc3) = chem(i, k, j, p_hc3) + ebu(i, k, j, &
&              p_ebu_hc3)*scalebb(i, j, p_scbb_hc3)*conv_rho
            g_chem(i, k, j, p_hc5) = g_chem(i, k, j, p_hc5) + ebu(i, k, &
&              j, p_ebu_hc5)*(g_scalebb(i, j, p_scbb_hc5)*conv_rho+&
&              scalebb(i, j, p_scbb_hc5)*g_conv_rho)
            chem(i, k, j, p_hc5) = chem(i, k, j, p_hc5) + ebu(i, k, j, &
&              p_ebu_hc5)*scalebb(i, j, p_scbb_hc5)*conv_rho
            g_chem(i, k, j, p_hc8) = g_chem(i, k, j, p_hc8) + ebu(i, k, &
&              j, p_ebu_hc8)*(g_scalebb(i, j, p_scbb_hc8)*conv_rho+&
&              scalebb(i, j, p_scbb_hc8)*g_conv_rho)
            chem(i, k, j, p_hc8) = chem(i, k, j, p_hc8) + ebu(i, k, j, &
&              p_ebu_hc8)*scalebb(i, j, p_scbb_hc8)*conv_rho
            g_chem(i, k, j, p_eth) = g_chem(i, k, j, p_eth) + ebu(i, k, &
&              j, p_ebu_eth)*(g_scalebb(i, j, p_scbb_eth)*conv_rho+&
&              scalebb(i, j, p_scbb_eth)*g_conv_rho)
            chem(i, k, j, p_eth) = chem(i, k, j, p_eth) + ebu(i, k, j, &
&              p_ebu_eth)*scalebb(i, j, p_scbb_eth)*conv_rho
            g_chem(i, k, j, p_co) = g_chem(i, k, j, p_co) + ebu(i, k, j&
&              , p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+scalebb(i&
&              , j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_co) = chem(i, k, j, p_co) + ebu(i, k, j, &
&              p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
            g_chem(i, k, j, p_olt) = g_chem(i, k, j, p_olt) + ebu(i, k, &
&              j, p_ebu_olt)*(g_scalebb(i, j, p_scbb_olt)*conv_rho+&
&              scalebb(i, j, p_scbb_olt)*g_conv_rho)
            chem(i, k, j, p_olt) = chem(i, k, j, p_olt) + ebu(i, k, j, &
&              p_ebu_olt)*scalebb(i, j, p_scbb_olt)*conv_rho
            g_chem(i, k, j, p_oli) = g_chem(i, k, j, p_oli) + ebu(i, k, &
&              j, p_ebu_oli)*(g_scalebb(i, j, p_scbb_oli)*conv_rho+&
&              scalebb(i, j, p_scbb_oli)*g_conv_rho)
            chem(i, k, j, p_oli) = chem(i, k, j, p_oli) + ebu(i, k, j, &
&              p_ebu_oli)*scalebb(i, j, p_scbb_oli)*conv_rho
            g_chem(i, k, j, p_tol) = g_chem(i, k, j, p_tol) + ebu(i, k, &
&              j, p_ebu_tol)*(g_scalebb(i, j, p_scbb_tol)*conv_rho+&
&              scalebb(i, j, p_scbb_tol)*g_conv_rho)
            chem(i, k, j, p_tol) = chem(i, k, j, p_tol) + ebu(i, k, j, &
&              p_ebu_tol)*scalebb(i, j, p_scbb_tol)*conv_rho
            g_chem(i, k, j, p_xyl) = g_chem(i, k, j, p_xyl) + ebu(i, k, &
&              j, p_ebu_xyl)*(g_scalebb(i, j, p_scbb_xyl)*conv_rho+&
&              scalebb(i, j, p_scbb_xyl)*g_conv_rho)
            chem(i, k, j, p_xyl) = chem(i, k, j, p_xyl) + ebu(i, k, j, &
&              p_ebu_xyl)*scalebb(i, j, p_scbb_xyl)*conv_rho
            g_chem(i, k, j, p_ket) = g_chem(i, k, j, p_ket) + ebu(i, k, &
&              j, p_ebu_ket)*(g_scalebb(i, j, p_scbb_ket)*conv_rho+&
&              scalebb(i, j, p_scbb_ket)*g_conv_rho)
            chem(i, k, j, p_ket) = chem(i, k, j, p_ket) + ebu(i, k, j, &
&              p_ebu_ket)*scalebb(i, j, p_scbb_ket)*conv_rho
          END DO
        END DO
      END DO
    CASE (GOCART_SIMPLE) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&              g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, &
&              j)*60.)
            g_chem(i, k, j, p_so2) = g_chem(i, k, j, p_so2) + ebu(i, k, &
&              j, p_ebu_so2)*(g_scalebb(i, j, p_scbb_so2)*conv_rho+&
&              scalebb(i, j, p_scbb_so2)*g_conv_rho)
            chem(i, k, j, p_so2) = chem(i, k, j, p_so2) + ebu(i, k, j, &
&              p_ebu_so2)*scalebb(i, j, p_scbb_so2)*conv_rho
            g_chem(i, k, j, p_sulf) = g_chem(i, k, j, p_sulf) + ebu(i, k&
&              , j, p_ebu_sulf)*(g_scalebb(i, j, p_scbb_sulf)*conv_rho+&
&              scalebb(i, j, p_scbb_sulf)*g_conv_rho)
            chem(i, k, j, p_sulf) = chem(i, k, j, p_sulf) + ebu(i, k, j&
&              , p_ebu_sulf)*scalebb(i, j, p_scbb_sulf)*conv_rho
            g_chem(i, k, j, p_dms) = g_chem(i, k, j, p_dms) + ebu(i, k, &
&              j, p_ebu_dms)*(g_scalebb(i, j, p_scbb_dms)*conv_rho+&
&              scalebb(i, j, p_scbb_dms)*g_conv_rho)
            chem(i, k, j, p_dms) = chem(i, k, j, p_dms) + ebu(i, k, j, &
&              p_ebu_dms)*scalebb(i, j, p_scbb_dms)*conv_rho
            g_chem(i, k, j, p_oc1) = g_chem(i, k, j, p_oc1) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_oc)*g_scalebb(i, j, p_scbb_oc)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_oc)*scalebb(i, j, &
&              p_scbb_oc)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i, k&
&              , j)**2-r_q*ebu(i, k, j, p_ebu_oc)*scalebb(i, j, p_scbb_oc&
&              )*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w(i, k, j)**&
&              2
            chem(i, k, j, p_oc1) = chem(i, k, j, p_oc1) + r_q*ebu(i, k, &
&              j, p_ebu_oc)*scalebb(i, j, p_scbb_oc)/rho_phy(i, k, j)*&
&              dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_bc1) = g_chem(i, k, j, p_bc1) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_bc)*g_scalebb(i, j, p_scbb_bc)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, &
&              p_scbb_bc)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i, k&
&              , j)**2-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, p_scbb_bc&
&              )*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w(i, k, j)**&
&              2
            chem(i, k, j, p_bc1) = chem(i, k, j, p_bc1) + r_q*ebu(i, k, &
&              j, p_ebu_bc)*scalebb(i, j, p_scbb_bc)/rho_phy(i, k, j)*&
&              dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_p25) = g_chem(i, k, j, p_p25) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_pm25)*g_scalebb(i, j, p_scbb_pm25)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_pm25)*scalebb(i, j&
&              , p_scbb_pm25)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i&
&              , k, j)**2-r_q*ebu(i, k, j, p_ebu_pm25)*scalebb(i, j, &
&              p_scbb_pm25)*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w&
&              (i, k, j)**2
            chem(i, k, j, p_p25) = chem(i, k, j, p_p25) + r_q*ebu(i, k, &
&              j, p_ebu_pm25)*scalebb(i, j, p_scbb_pm25)/rho_phy(i, k, j)&
&              *dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_p10) = g_chem(i, k, j, p_p10) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_pm10)*g_scalebb(i, j, p_scbb_pm10)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_pm10)*scalebb(i, j&
&              , p_scbb_pm10)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i&
&              , k, j)**2-r_q*ebu(i, k, j, p_ebu_pm10)*scalebb(i, j, &
&              p_scbb_pm10)*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w&
&              (i, k, j)**2
            chem(i, k, j, p_p10) = chem(i, k, j, p_p10) + r_q*ebu(i, k, &
&              j, p_ebu_pm10)*scalebb(i, j, p_scbb_pm10)/rho_phy(i, k, j)&
&              *dtstep/dz8w(i, k, j)
          END DO
        END DO
      END DO
    CASE (GOCART_BCCO) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&              g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, &
&              j)*60.)
            g_chem(i, k, j, p_co) = g_chem(i, k, j, p_co) + ebu(i, k, j&
&              , p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+scalebb(i&
&              , j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_co) = chem(i, k, j, p_co) + ebu(i, k, j, &
&              p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho

            g_chem(i, k, j, p_bc1) = g_chem(i, k, j, p_bc1) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_bc)*g_scalebb(i, j, p_scbb_bc)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, &
&              p_scbb_bc)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i, k&
&              , j)**2-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, p_scbb_bc&
&              )*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w(i, k, j)**&
&              2
            chem(i, k, j, p_bc1) = chem(i, k, j, p_bc1) + r_q*ebu(i, k, &
&              j, p_ebu_bc)*scalebb(i, j, p_scbb_bc)/rho_phy(i, k, j)*&
&              dtstep/dz8w(i, k, j)
          END DO
        END DO
      END DO
    CASE (GOCART_BC)
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_chem(i, k, j, p_bc1) = g_chem(i, k, j, p_bc1) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_bc)*g_scalebb(i, j, p_scbb_bc)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, &
&              p_scbb_bc)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i, k&
&              , j)**2-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, p_scbb_bc&
&              )*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w(i, k, j)**&
&              2
            chem(i, k, j, p_bc1) = chem(i, k, j, p_bc1) + r_q*ebu(i, k, &
&              j, p_ebu_bc)*scalebb(i, j, p_scbb_bc)/rho_phy(i, k, j)*&
&              dtstep/dz8w(i, k, j)
          END DO
        END DO
      END DO
    CASE (GOCARTRACM_KPP, GOCARTRADM2) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&              g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, &
&              j)*60.)
            g_chem(i, k, j, p_so2) = g_chem(i, k, j, p_so2) + ebu(i, k, &
&              j, p_ebu_so2)*(g_scalebb(i, j, p_scbb_so2)*conv_rho+&
&              scalebb(i, j, p_scbb_so2)*g_conv_rho)
            chem(i, k, j, p_so2) = chem(i, k, j, p_so2) + ebu(i, k, j, &
&              p_ebu_so2)*scalebb(i, j, p_scbb_so2)*conv_rho
            g_chem(i, k, j, p_sulf) = g_chem(i, k, j, p_sulf) + ebu(i, k&
&              , j, p_ebu_sulf)*(g_scalebb(i, j, p_scbb_sulf)*conv_rho+&
&              scalebb(i, j, p_scbb_sulf)*g_conv_rho)
            chem(i, k, j, p_sulf) = chem(i, k, j, p_sulf) + ebu(i, k, j&
&              , p_ebu_sulf)*scalebb(i, j, p_scbb_sulf)*conv_rho
            g_chem(i, k, j, p_dms) = g_chem(i, k, j, p_dms) + ebu(i, k, &
&              j, p_ebu_dms)*(g_scalebb(i, j, p_scbb_dms)*conv_rho+&
&              scalebb(i, j, p_scbb_dms)*g_conv_rho)
            chem(i, k, j, p_dms) = chem(i, k, j, p_dms) + ebu(i, k, j, &
&              p_ebu_dms)*scalebb(i, j, p_scbb_dms)*conv_rho
            g_chem(i, k, j, p_csl) = g_chem(i, k, j, p_csl) + ebu(i, k, &
&              j, p_ebu_csl)*(g_scalebb(i, j, p_scbb_csl)*conv_rho+&
&              scalebb(i, j, p_scbb_csl)*g_conv_rho)
            chem(i, k, j, p_csl) = chem(i, k, j, p_csl) + ebu(i, k, j, &
&              p_ebu_csl)*scalebb(i, j, p_scbb_csl)*conv_rho
            g_chem(i, k, j, p_iso) = g_chem(i, k, j, p_iso) + ebu(i, k, &
&              j, p_ebu_iso)*(g_scalebb(i, j, p_scbb_iso)*conv_rho+&
&              scalebb(i, j, p_scbb_iso)*g_conv_rho)
            chem(i, k, j, p_iso) = chem(i, k, j, p_iso) + ebu(i, k, j, &
&              p_ebu_iso)*scalebb(i, j, p_scbb_iso)*conv_rho
            g_chem(i, k, j, p_no) = g_chem(i, k, j, p_no) + ebu(i, k, j&
&              , p_ebu_no)*(g_scalebb(i, j, p_scbb_no)*conv_rho+scalebb(i&
&              , j, p_scbb_no)*g_conv_rho)
            chem(i, k, j, p_no) = chem(i, k, j, p_no) + ebu(i, k, j, &
&              p_ebu_no)*scalebb(i, j, p_scbb_no)*conv_rho
            g_chem(i, k, j, p_no2) = g_chem(i, k, j, p_no2) + ebu(i, k, &
&              j, p_ebu_no2)*(g_scalebb(i, j, p_scbb_no2)*conv_rho+&
&              scalebb(i, j, p_scbb_no2)*g_conv_rho)
            chem(i, k, j, p_no2) = chem(i, k, j, p_no2) + ebu(i, k, j, &
&              p_ebu_no2)*scalebb(i, j, p_scbb_no2)*conv_rho
            g_chem(i, k, j, p_ald) = g_chem(i, k, j, p_ald) + ebu(i, k, &
&              j, p_ebu_ald)*(g_scalebb(i, j, p_scbb_ald)*conv_rho+&
&              scalebb(i, j, p_scbb_ald)*g_conv_rho)
            chem(i, k, j, p_ald) = chem(i, k, j, p_ald) + ebu(i, k, j, &
&              p_ebu_ald)*scalebb(i, j, p_scbb_ald)*conv_rho
            g_chem(i, k, j, p_hcho) = g_chem(i, k, j, p_hcho) + ebu(i, k&
&              , j, p_ebu_hcho)*(g_scalebb(i, j, p_scbb_hcho)*conv_rho+&
&              scalebb(i, j, p_scbb_hcho)*g_conv_rho)
            chem(i, k, j, p_hcho) = chem(i, k, j, p_hcho) + ebu(i, k, j&
&              , p_ebu_hcho)*scalebb(i, j, p_scbb_hcho)*conv_rho
            g_chem(i, k, j, p_ora2) = g_chem(i, k, j, p_ora2) + ebu(i, k&
&              , j, p_ebu_ora2)*(g_scalebb(i, j, p_scbb_ora2)*conv_rho+&
&              scalebb(i, j, p_scbb_ora2)*g_conv_rho)
            chem(i, k, j, p_ora2) = chem(i, k, j, p_ora2) + ebu(i, k, j&
&              , p_ebu_ora2)*scalebb(i, j, p_scbb_ora2)*conv_rho
            g_chem(i, k, j, p_hc3) = g_chem(i, k, j, p_hc3) + ebu(i, k, &
&              j, p_ebu_hc3)*(g_scalebb(i, j, p_scbb_hc3)*conv_rho+&
&              scalebb(i, j, p_scbb_hc3)*g_conv_rho)
            chem(i, k, j, p_hc3) = chem(i, k, j, p_hc3) + ebu(i, k, j, &
&              p_ebu_hc3)*scalebb(i, j, p_scbb_hc3)*conv_rho
            g_chem(i, k, j, p_hc5) = g_chem(i, k, j, p_hc5) + ebu(i, k, &
&              j, p_ebu_hc5)*(g_scalebb(i, j, p_scbb_hc5)*conv_rho+&
&              scalebb(i, j, p_scbb_hc5)*g_conv_rho)
            chem(i, k, j, p_hc5) = chem(i, k, j, p_hc5) + ebu(i, k, j, &
&              p_ebu_hc5)*scalebb(i, j, p_scbb_hc5)*conv_rho
            g_chem(i, k, j, p_hc8) = g_chem(i, k, j, p_hc8) + ebu(i, k, &
&              j, p_ebu_hc8)*(g_scalebb(i, j, p_scbb_hc8)*conv_rho+&
&              scalebb(i, j, p_scbb_hc8)*g_conv_rho)
            chem(i, k, j, p_hc8) = chem(i, k, j, p_hc8) + ebu(i, k, j, &
&              p_ebu_hc8)*scalebb(i, j, p_scbb_hc8)*conv_rho
            g_chem(i, k, j, p_eth) = g_chem(i, k, j, p_eth) + ebu(i, k, &
&              j, p_ebu_eth)*(g_scalebb(i, j, p_scbb_eth)*conv_rho+&
&              scalebb(i, j, p_scbb_eth)*g_conv_rho)
            chem(i, k, j, p_eth) = chem(i, k, j, p_eth) + ebu(i, k, j, &
&              p_ebu_eth)*scalebb(i, j, p_scbb_eth)*conv_rho
            g_chem(i, k, j, p_co) = g_chem(i, k, j, p_co) + ebu(i, k, j&
&              , p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+scalebb(i&
&              , j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_co) = chem(i, k, j, p_co) + ebu(i, k, j, &
&              p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
            g_chem(i, k, j, p_olt) = g_chem(i, k, j, p_olt) + ebu(i, k, &
&              j, p_ebu_olt)*(g_scalebb(i, j, p_scbb_olt)*conv_rho+&
&              scalebb(i, j, p_scbb_olt)*g_conv_rho)
            chem(i, k, j, p_olt) = chem(i, k, j, p_olt) + ebu(i, k, j, &
&              p_ebu_olt)*scalebb(i, j, p_scbb_olt)*conv_rho
            g_chem(i, k, j, p_oli) = g_chem(i, k, j, p_oli) + ebu(i, k, &
&              j, p_ebu_oli)*(g_scalebb(i, j, p_scbb_oli)*conv_rho+&
&              scalebb(i, j, p_scbb_oli)*g_conv_rho)
            chem(i, k, j, p_oli) = chem(i, k, j, p_oli) + ebu(i, k, j, &
&              p_ebu_oli)*scalebb(i, j, p_scbb_oli)*conv_rho
            g_chem(i, k, j, p_tol) = g_chem(i, k, j, p_tol) + ebu(i, k, &
&              j, p_ebu_tol)*(g_scalebb(i, j, p_scbb_tol)*conv_rho+&
&              scalebb(i, j, p_scbb_tol)*g_conv_rho)
            chem(i, k, j, p_tol) = chem(i, k, j, p_tol) + ebu(i, k, j, &
&              p_ebu_tol)*scalebb(i, j, p_scbb_tol)*conv_rho
            g_chem(i, k, j, p_xyl) = g_chem(i, k, j, p_xyl) + ebu(i, k, &
&              j, p_ebu_xyl)*(g_scalebb(i, j, p_scbb_xyl)*conv_rho+&
&              scalebb(i, j, p_scbb_xyl)*g_conv_rho)
            chem(i, k, j, p_xyl) = chem(i, k, j, p_xyl) + ebu(i, k, j, &
&              p_ebu_xyl)*scalebb(i, j, p_scbb_xyl)*conv_rho
            g_chem(i, k, j, p_ket) = g_chem(i, k, j, p_ket) + ebu(i, k, &
&              j, p_ebu_ket)*(g_scalebb(i, j, p_scbb_ket)*conv_rho+&
&              scalebb(i, j, p_scbb_ket)*g_conv_rho)
            chem(i, k, j, p_ket) = chem(i, k, j, p_ket) + ebu(i, k, j, &
&              p_ebu_ket)*scalebb(i, j, p_scbb_ket)*conv_rho
            g_chem(i, k, j, p_oc1) = g_chem(i, k, j, p_oc1) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_oc)*g_scalebb(i, j, p_scbb_oc)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_oc)*scalebb(i, j, &
&              p_scbb_oc)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i, k&
&              , j)**2-r_q*ebu(i, k, j, p_ebu_oc)*scalebb(i, j, p_scbb_oc&
&              )*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w(i, k, j)**&
&              2
            chem(i, k, j, p_oc1) = chem(i, k, j, p_oc1) + r_q*ebu(i, k, &
&              j, p_ebu_oc)*scalebb(i, j, p_scbb_oc)/rho_phy(i, k, j)*&
&              dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_bc1) = g_chem(i, k, j, p_bc1) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_bc)*g_scalebb(i, j, p_scbb_bc)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, &
&              p_scbb_bc)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i, k&
&              , j)**2-r_q*ebu(i, k, j, p_ebu_bc)*scalebb(i, j, p_scbb_bc&
&              )*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w(i, k, j)**&
&              2
            chem(i, k, j, p_bc1) = chem(i, k, j, p_bc1) + r_q*ebu(i, k, &
&              j, p_ebu_bc)*scalebb(i, j, p_scbb_bc)/rho_phy(i, k, j)*&
&              dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_p25) = g_chem(i, k, j, p_p25) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_pm25)*g_scalebb(i, j, p_scbb_pm25)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_pm25)*scalebb(i, j&
&              , p_scbb_pm25)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i&
&              , k, j)**2-r_q*ebu(i, k, j, p_ebu_pm25)*scalebb(i, j, &
&              p_scbb_pm25)*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w&
&              (i, k, j)**2
            chem(i, k, j, p_p25) = chem(i, k, j, p_p25) + r_q*ebu(i, k, &
&              j, p_ebu_pm25)*scalebb(i, j, p_scbb_pm25)/rho_phy(i, k, j)&
&              *dtstep/dz8w(i, k, j)
            g_chem(i, k, j, p_p10) = g_chem(i, k, j, p_p10) + (dtstep*(&
&              r_q*ebu(i, k, j, p_ebu_pm10)*g_scalebb(i, j, p_scbb_pm10)*&
&              rho_phy(i, k, j)-r_q*ebu(i, k, j, p_ebu_pm10)*scalebb(i, j&
&              , p_scbb_pm10)*g_rho_phy(i, k, j))*dz8w(i, k, j)/rho_phy(i&
&              , k, j)**2-r_q*ebu(i, k, j, p_ebu_pm10)*scalebb(i, j, &
&              p_scbb_pm10)*dtstep*g_dz8w(i, k, j)/rho_phy(i, k, j))/dz8w&
&              (i, k, j)**2
            chem(i, k, j, p_p10) = chem(i, k, j, p_p10) + r_q*ebu(i, k, &
&              j, p_ebu_pm10)*scalebb(i, j, p_scbb_pm10)/rho_phy(i, k, j)&
&              *dtstep/dz8w(i, k, j)
          END DO
        END DO
      END DO
    CASE (RADM2, RACM_KPP, RACM_MIM_KPP, SAPRC99_KPP, &
&    saprc99_mosaic_4bin_vbs2_kpp) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts,kte
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)/(rho_phy(i, k, j)**2*60.))-r_q*4.828e-4*dtstep*&
&              g_dz8w(i, k, j)/(rho_phy(i, k, j)*60.))/dz8w(i, k, j)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/60./dz8w(i, &
&              k, j)
            g_chem(i, k, j, p_csl) = g_chem(i, k, j, p_csl) + ebu(i, k, &
&              j, p_ebu_csl)*(g_scalebb(i, j, p_scbb_csl)*conv_rho+&
&              scalebb(i, j, p_scbb_csl)*g_conv_rho)
            chem(i, k, j, p_csl) = chem(i, k, j, p_csl) + ebu(i, k, j, &
&              p_ebu_csl)*scalebb(i, j, p_scbb_csl)*conv_rho
            g_chem(i, k, j, p_iso) = g_chem(i, k, j, p_iso) + ebu(i, k, &
&              j, p_ebu_iso)*(g_scalebb(i, j, p_scbb_iso)*conv_rho+&
&              scalebb(i, j, p_scbb_iso)*g_conv_rho)
            chem(i, k, j, p_iso) = chem(i, k, j, p_iso) + ebu(i, k, j, &
&              p_ebu_iso)*scalebb(i, j, p_scbb_iso)*conv_rho
            g_chem(i, k, j, p_no) = g_chem(i, k, j, p_no) + ebu(i, k, j&
&              , p_ebu_no)*(g_scalebb(i, j, p_scbb_no)*conv_rho+scalebb(i&
&              , j, p_scbb_no)*g_conv_rho)
            chem(i, k, j, p_no) = chem(i, k, j, p_no) + ebu(i, k, j, &
&              p_ebu_no)*scalebb(i, j, p_scbb_no)*conv_rho
            g_chem(i, k, j, p_no2) = g_chem(i, k, j, p_no2) + ebu(i, k, &
&              j, p_ebu_no2)*(g_scalebb(i, j, p_scbb_no2)*conv_rho+&
&              scalebb(i, j, p_scbb_no2)*g_conv_rho)
            chem(i, k, j, p_no2) = chem(i, k, j, p_no2) + ebu(i, k, j, &
&              p_ebu_no2)*scalebb(i, j, p_scbb_no2)*conv_rho
            g_chem(i, k, j, p_ald) = g_chem(i, k, j, p_ald) + ebu(i, k, &
&              j, p_ebu_ald)*(g_scalebb(i, j, p_scbb_ald)*conv_rho+&
&              scalebb(i, j, p_scbb_ald)*g_conv_rho)
            chem(i, k, j, p_ald) = chem(i, k, j, p_ald) + ebu(i, k, j, &
&              p_ebu_ald)*scalebb(i, j, p_scbb_ald)*conv_rho
            g_chem(i, k, j, p_hcho) = g_chem(i, k, j, p_hcho) + ebu(i, k&
&              , j, p_ebu_hcho)*(g_scalebb(i, j, p_scbb_hcho)*conv_rho+&
&              scalebb(i, j, p_scbb_hcho)*g_conv_rho)
            chem(i, k, j, p_hcho) = chem(i, k, j, p_hcho) + ebu(i, k, j&
&              , p_ebu_hcho)*scalebb(i, j, p_scbb_hcho)*conv_rho
            g_chem(i, k, j, p_ora2) = g_chem(i, k, j, p_ora2) + ebu(i, k&
&              , j, p_ebu_ora2)*(g_scalebb(i, j, p_scbb_ora2)*conv_rho+&
&              scalebb(i, j, p_scbb_ora2)*g_conv_rho)
            chem(i, k, j, p_ora2) = chem(i, k, j, p_ora2) + ebu(i, k, j&
&              , p_ebu_ora2)*scalebb(i, j, p_scbb_ora2)*conv_rho
            g_chem(i, k, j, p_hc3) = g_chem(i, k, j, p_hc3) + ebu(i, k, &
&              j, p_ebu_hc3)*(g_scalebb(i, j, p_scbb_hc3)*conv_rho+&
&              scalebb(i, j, p_scbb_hc3)*g_conv_rho)
            chem(i, k, j, p_hc3) = chem(i, k, j, p_hc3) + ebu(i, k, j, &
&              p_ebu_hc3)*scalebb(i, j, p_scbb_hc3)*conv_rho
            g_chem(i, k, j, p_hc5) = g_chem(i, k, j, p_hc5) + ebu(i, k, &
&              j, p_ebu_hc5)*(g_scalebb(i, j, p_scbb_hc5)*conv_rho+&
&              scalebb(i, j, p_scbb_hc5)*g_conv_rho)
            chem(i, k, j, p_hc5) = chem(i, k, j, p_hc5) + ebu(i, k, j, &
&              p_ebu_hc5)*scalebb(i, j, p_scbb_hc5)*conv_rho
            g_chem(i, k, j, p_hc8) = g_chem(i, k, j, p_hc8) + ebu(i, k, &
&              j, p_ebu_hc8)*(g_scalebb(i, j, p_scbb_hc8)*conv_rho+&
&              scalebb(i, j, p_scbb_hc8)*g_conv_rho)
            chem(i, k, j, p_hc8) = chem(i, k, j, p_hc8) + ebu(i, k, j, &
&              p_ebu_hc8)*scalebb(i, j, p_scbb_hc8)*conv_rho
            g_chem(i, k, j, p_eth) = g_chem(i, k, j, p_eth) + ebu(i, k, &
&              j, p_ebu_eth)*(g_scalebb(i, j, p_scbb_eth)*conv_rho+&
&              scalebb(i, j, p_scbb_eth)*g_conv_rho)
            chem(i, k, j, p_eth) = chem(i, k, j, p_eth) + ebu(i, k, j, &
&              p_ebu_eth)*scalebb(i, j, p_scbb_eth)*conv_rho
            g_chem(i, k, j, p_co) = g_chem(i, k, j, p_co) + ebu(i, k, j&
&              , p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+scalebb(i&
&              , j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_co) = chem(i, k, j, p_co) + ebu(i, k, j, &
&              p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
            g_chem(i, k, j, p_olt) = g_chem(i, k, j, p_olt) + ebu(i, k, &
&              j, p_ebu_olt)*(g_scalebb(i, j, p_scbb_olt)*conv_rho+&
&              scalebb(i, j, p_scbb_olt)*g_conv_rho)
            chem(i, k, j, p_olt) = chem(i, k, j, p_olt) + ebu(i, k, j, &
&              p_ebu_olt)*scalebb(i, j, p_scbb_olt)*conv_rho
            g_chem(i, k, j, p_oli) = g_chem(i, k, j, p_oli) + ebu(i, k, &
&              j, p_ebu_oli)*(g_scalebb(i, j, p_scbb_oli)*conv_rho+&
&              scalebb(i, j, p_scbb_oli)*g_conv_rho)
            chem(i, k, j, p_oli) = chem(i, k, j, p_oli) + ebu(i, k, j, &
&              p_ebu_oli)*scalebb(i, j, p_scbb_oli)*conv_rho
            g_chem(i, k, j, p_tol) = g_chem(i, k, j, p_tol) + ebu(i, k, &
&              j, p_ebu_tol)*(g_scalebb(i, j, p_scbb_tol)*conv_rho+&
&              scalebb(i, j, p_scbb_tol)*g_conv_rho)
            chem(i, k, j, p_tol) = chem(i, k, j, p_tol) + ebu(i, k, j, &
&              p_ebu_tol)*scalebb(i, j, p_scbb_tol)*conv_rho
            g_chem(i, k, j, p_xyl) = g_chem(i, k, j, p_xyl) + ebu(i, k, &
&              j, p_ebu_xyl)*(g_scalebb(i, j, p_scbb_xyl)*conv_rho+&
&              scalebb(i, j, p_scbb_xyl)*g_conv_rho)
            chem(i, k, j, p_xyl) = chem(i, k, j, p_xyl) + ebu(i, k, j, &
&              p_ebu_xyl)*scalebb(i, j, p_scbb_xyl)*conv_rho
            g_chem(i, k, j, p_ket) = g_chem(i, k, j, p_ket) + ebu(i, k, &
&              j, p_ebu_ket)*(g_scalebb(i, j, p_scbb_ket)*conv_rho+&
&              scalebb(i, j, p_scbb_ket)*g_conv_rho)
            chem(i, k, j, p_ket) = chem(i, k, j, p_ket) + ebu(i, k, j, &
&              p_ebu_ket)*scalebb(i, j, p_scbb_ket)*conv_rho
          END DO
        END DO
      END DO
    CASE (MOZART_KPP,MOZCART_KPP,MOZART_MOSAIC_4BIN_KPP, MOZART_MOSAIC_4BIN_AQ_KPP )
      IF (biomass_burn_opt .EQ. biomassb_mozc .OR. biomass_burn_opt .EQ.&
&          biomassb_moz) THEN
        DO j=jts,jte
          DO k=kts,kte
            DO i=its,ite
              g_conv_rho = -(r_q*4.828e-4*dtstep*60.*(g_rho_phy(i, k, j)&
&                *dz8w(i, k, j)+rho_phy(i, k, j)*g_dz8w(i, k, j))/(&
&                rho_phy(i, k, j)*60.*dz8w(i, k, j))**2)
              conv_rho = r_q*4.828e-4*dtstep/(rho_phy(i, k, j)*60.*dz8w(&
&                i, k, j))
              g_chem(i, k, j, p_co) = g_chem(i, k, j, p_co) + ebu(i, k, &
&                j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+&
&                scalebb(i, j, p_scbb_co)*g_conv_rho)
              chem(i, k, j, p_co) = chem(i, k, j, p_co) + ebu(i, k, j, &
&                p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
              g_chem(i, k, j, p_no) = g_chem(i, k, j, p_no) + ebu(i, k, &
&                j, p_ebu_no)*(g_scalebb(i, j, p_scbb_no)*conv_rho+&
&                scalebb(i, j, p_scbb_no)*g_conv_rho)
              chem(i, k, j, p_no) = chem(i, k, j, p_no) + ebu(i, k, j, &
&                p_ebu_no)*scalebb(i, j, p_scbb_no)*conv_rho
              g_chem(i, k, j, p_no2) = g_chem(i, k, j, p_no2) + ebu(i, k&
&                , j, p_ebu_no2)*(g_scalebb(i, j, p_scbb_no2)*conv_rho+&
&                scalebb(i, j, p_scbb_no2)*g_conv_rho)
              chem(i, k, j, p_no2) = chem(i, k, j, p_no2) + ebu(i, k, j&
&                , p_ebu_no2)*scalebb(i, j, p_scbb_no2)*conv_rho
              g_chem(i, k, j, p_bigalk) = g_chem(i, k, j, p_bigalk) + &
&                ebu(i, k, j, p_ebu_bigalk)*(g_scalebb(i, j, &
&                p_scbb_bigalk)*conv_rho+scalebb(i, j, p_scbb_bigalk)*&
&                g_conv_rho)
              chem(i, k, j, p_bigalk) = chem(i, k, j, p_bigalk) + ebu(i&
&                , k, j, p_ebu_bigalk)*scalebb(i, j, p_scbb_bigalk)*&
&                conv_rho
              g_chem(i, k, j, p_bigene) = g_chem(i, k, j, p_bigene) + &
&                ebu(i, k, j, p_ebu_bigene)*(g_scalebb(i, j, &
&                p_scbb_bigene)*conv_rho+scalebb(i, j, p_scbb_bigene)*&
&                g_conv_rho)
              chem(i, k, j, p_bigene) = chem(i, k, j, p_bigene) + ebu(i&
&                , k, j, p_ebu_bigene)*scalebb(i, j, p_scbb_bigene)*&
&                conv_rho
              g_chem(i, k, j, p_c2h4) = g_chem(i, k, j, p_c2h4) + ebu(i&
&                , k, j, p_ebu_c2h4)*(g_scalebb(i, j, p_scbb_c2h4)*&
&                conv_rho+scalebb(i, j, p_scbb_c2h4)*g_conv_rho)
              chem(i, k, j, p_c2h4) = chem(i, k, j, p_c2h4) + ebu(i, k, &
&                j, p_ebu_c2h4)*scalebb(i, j, p_scbb_c2h4)*conv_rho
              g_chem(i, k, j, p_c2h5oh) = g_chem(i, k, j, p_c2h5oh) + &
&                ebu(i, k, j, p_ebu_c2h5oh)*(g_scalebb(i, j, &
&                p_scbb_c2h5oh)*conv_rho+scalebb(i, j, p_scbb_c2h5oh)*&
&                g_conv_rho)
              chem(i, k, j, p_c2h5oh) = chem(i, k, j, p_c2h5oh) + ebu(i&
&                , k, j, p_ebu_c2h5oh)*scalebb(i, j, p_scbb_c2h5oh)*&
&                conv_rho
              g_chem(i, k, j, p_c2h6) = g_chem(i, k, j, p_c2h6) + ebu(i&
&                , k, j, p_ebu_c2h6)*(g_scalebb(i, j, p_scbb_c2h6)*&
&                conv_rho+scalebb(i, j, p_scbb_c2h6)*g_conv_rho)
              chem(i, k, j, p_c2h6) = chem(i, k, j, p_c2h6) + ebu(i, k, &
&                j, p_ebu_c2h6)*scalebb(i, j, p_scbb_c2h6)*conv_rho
              g_chem(i, k, j, p_c3h6) = g_chem(i, k, j, p_c3h6) + ebu(i&
&                , k, j, p_ebu_c3h6)*(g_scalebb(i, j, p_scbb_c3h6)*&
&                conv_rho+scalebb(i, j, p_scbb_c3h6)*g_conv_rho)
              chem(i, k, j, p_c3h6) = chem(i, k, j, p_c3h6) + ebu(i, k, &
&                j, p_ebu_c3h6)*scalebb(i, j, p_scbb_c3h6)*conv_rho
              g_chem(i, k, j, p_c3h8) = g_chem(i, k, j, p_c3h8) + ebu(i&
&                , k, j, p_ebu_c3h8)*(g_scalebb(i, j, p_scbb_c3h8)*&
&                conv_rho+scalebb(i, j, p_scbb_c3h8)*g_conv_rho)
              chem(i, k, j, p_c3h8) = chem(i, k, j, p_c3h8) + ebu(i, k, &
&                j, p_ebu_c3h8)*scalebb(i, j, p_scbb_c3h8)*conv_rho
              g_chem(i, k, j, p_hcho) = g_chem(i, k, j, p_hcho) + ebu(i&
&                , k, j, p_ebu_ch2o)*(g_scalebb(i, j, p_scbb_ch2o)*&
&                conv_rho+scalebb(i, j, p_scbb_ch2o)*g_conv_rho)
              chem(i, k, j, p_hcho) = chem(i, k, j, p_hcho) + ebu(i, k, &
&                j, p_ebu_ch2o)*scalebb(i, j, p_scbb_ch2o)*conv_rho
              g_chem(i, k, j, p_ald) = g_chem(i, k, j, p_ald) + ebu(i, k&
&                , j, p_ebu_ch3cho)*(g_scalebb(i, j, p_scbb_ch3cho)*&
&                conv_rho+scalebb(i, j, p_scbb_ch3cho)*g_conv_rho)
              chem(i, k, j, p_ald) = chem(i, k, j, p_ald) + ebu(i, k, j&
&                , p_ebu_ch3cho)*scalebb(i, j, p_scbb_ch3cho)*conv_rho
              g_chem(i, k, j, p_acetol) = g_chem(i, k, j, p_acetol) + &
&                ebu(i, k, j, p_ebu_acetol)*(g_scalebb(i, j, &
&                p_scbb_acetol)*conv_rho+scalebb(i, j, p_scbb_acetol)*&
&                g_conv_rho)
              chem(i, k, j, p_acetol) = chem(i, k, j, p_acetol) + ebu(i&
&                , k, j, p_ebu_acetol)*scalebb(i, j, p_scbb_acetol)*&
&                conv_rho
              g_chem(i, k, j, p_isopr) = g_chem(i, k, j, p_isopr) + ebu(&
&                i, k, j, p_ebu_isop)*(g_scalebb(i, j, p_scbb_isop)*&
&                conv_rho+scalebb(i, j, p_scbb_isop)*g_conv_rho)
              chem(i, k, j, p_isopr) = chem(i, k, j, p_isopr) + ebu(i, k&
&                , j, p_ebu_isop)*scalebb(i, j, p_scbb_isop)*conv_rho
              g_chem(i, k, j, p_macr) = g_chem(i, k, j, p_macr) + ebu(i&
&                , k, j, p_ebu_macr)*(g_scalebb(i, j, p_scbb_macr)*&
&                conv_rho+scalebb(i, j, p_scbb_macr)*g_conv_rho)
              chem(i, k, j, p_macr) = chem(i, k, j, p_macr) + ebu(i, k, &
&                j, p_ebu_macr)*scalebb(i, j, p_scbb_macr)*conv_rho
              g_chem(i, k, j, p_mvk) = g_chem(i, k, j, p_mvk) + ebu(i, k&
&                , j, p_ebu_mvk)*(g_scalebb(i, j, p_scbb_mvk)*conv_rho+&
&                scalebb(i, j, p_scbb_mvk)*g_conv_rho)
              chem(i, k, j, p_mvk) = chem(i, k, j, p_mvk) + ebu(i, k, j&
&                , p_ebu_mvk)*scalebb(i, j, p_scbb_mvk)*conv_rho
              g_chem(i, k, j, p_acet) = g_chem(i, k, j, p_acet) + ebu(i&
&                , k, j, p_ebu_ch3coch3)*(g_scalebb(i, j, p_scbb_ch3coch3&
&                )*conv_rho+scalebb(i, j, p_scbb_ch3coch3)*g_conv_rho)
              chem(i, k, j, p_acet) = chem(i, k, j, p_acet) + ebu(i, k, &
&                j, p_ebu_ch3coch3)*scalebb(i, j, p_scbb_ch3coch3)*&
&                conv_rho
              g_chem(i, k, j, p_ch3oh) = g_chem(i, k, j, p_ch3oh) + ebu(&
&                i, k, j, p_ebu_ch3oh)*(g_scalebb(i, j, p_scbb_ch3oh)*&
&                conv_rho+scalebb(i, j, p_scbb_ch3oh)*g_conv_rho)
              chem(i, k, j, p_ch3oh) = chem(i, k, j, p_ch3oh) + ebu(i, k&
&                , j, p_ebu_ch3oh)*scalebb(i, j, p_scbb_ch3oh)*conv_rho
              g_chem(i, k, j, p_mek) = g_chem(i, k, j, p_mek) + ebu(i, k&
&                , j, p_ebu_mek)*(g_scalebb(i, j, p_scbb_mek)*conv_rho+&
&                scalebb(i, j, p_scbb_mek)*g_conv_rho)
              chem(i, k, j, p_mek) = chem(i, k, j, p_mek) + ebu(i, k, j&
&                , p_ebu_mek)*scalebb(i, j, p_scbb_mek)*conv_rho
              g_chem(i, k, j, p_so2) = g_chem(i, k, j, p_so2) + ebu(i, k&
&                , j, p_ebu_so2)*(g_scalebb(i, j, p_scbb_so2)*conv_rho+&
&                scalebb(i, j, p_scbb_so2)*g_conv_rho)
              chem(i, k, j, p_so2) = chem(i, k, j, p_so2) + ebu(i, k, j&
&                , p_ebu_so2)*scalebb(i, j, p_scbb_so2)*conv_rho
              g_chem(i, k, j, p_tol) = g_chem(i, k, j, p_tol) + ebu(i, k&
&                , j, p_ebu_toluene)*(g_scalebb(i, j, p_scbb_toluene)*&
&                conv_rho+scalebb(i, j, p_scbb_toluene)*g_conv_rho)
              chem(i, k, j, p_tol) = chem(i, k, j, p_tol) + ebu(i, k, j&
&                , p_ebu_toluene)*scalebb(i, j, p_scbb_toluene)*conv_rho
              g_chem(i, k, j, p_nh3) = g_chem(i, k, j, p_nh3) + ebu(i, k&
&                , j, p_ebu_nh3)*(g_scalebb(i, j, p_scbb_nh3)*conv_rho+&
&                scalebb(i, j, p_scbb_nh3)*g_conv_rho)
              chem(i, k, j, p_nh3) = chem(i, k, j, p_nh3) + ebu(i, k, j&
&                , p_ebu_nh3)*scalebb(i, j, p_scbb_nh3)*conv_rho
              g_chem(i, k, j, p_open) = g_chem(i, k, j, p_open) + ebu(i&
&                , k, j, p_ebu_open)*(g_scalebb(i, j, p_scbb_open)*&
&                conv_rho+scalebb(i, j, p_scbb_open)*g_conv_rho)
              chem(i, k, j, p_open) = chem(i, k, j, p_open) + ebu(i, k, &
&                j, p_ebu_open)*scalebb(i, j, p_scbb_open)*conv_rho
              g_chem(i, k, j, p_c10h16) = g_chem(i, k, j, p_c10h16) + &
&                ebu(i, k, j, p_ebu_c10h16)*(g_scalebb(i, j, &
&                p_scbb_c10h16)*conv_rho+scalebb(i, j, p_scbb_c10h16)*&
&                g_conv_rho)
              chem(i, k, j, p_c10h16) = chem(i, k, j, p_c10h16) + ebu(i&
&                , k, j, p_ebu_c10h16)*scalebb(i, j, p_scbb_c10h16)*&
&                conv_rho
              g_chem(i, k, j, p_cres) = g_chem(i, k, j, p_cres) + ebu(i&
&                , k, j, p_ebu_cres)*(g_scalebb(i, j, p_scbb_cres)*&
&                conv_rho+scalebb(i, j, p_scbb_cres)*g_conv_rho)
              chem(i, k, j, p_cres) = chem(i, k, j, p_cres) + ebu(i, k, &
&                j, p_ebu_cres)*scalebb(i, j, p_scbb_cres)*conv_rho
              g_chem(i, k, j, p_glyald) = g_chem(i, k, j, p_glyald) + &
&                ebu(i, k, j, p_ebu_glyald)*(g_scalebb(i, j, &
&                p_scbb_glyald)*conv_rho+scalebb(i, j, p_scbb_glyald)*&
&                g_conv_rho)
              chem(i, k, j, p_glyald) = chem(i, k, j, p_glyald) + ebu(i&
&                , k, j, p_ebu_glyald)*scalebb(i, j, p_scbb_glyald)*&
&                conv_rho
              g_chem(i, k, j, p_gly) = g_chem(i, k, j, p_gly) + ebu(i, k&
&                , j, p_ebu_gly)*(g_scalebb(i, j, p_scbb_gly)*conv_rho+&
&                scalebb(i, j, p_scbb_gly)*g_conv_rho)
              chem(i, k, j, p_gly) = chem(i, k, j, p_gly) + ebu(i, k, j&
&                , p_ebu_gly)*scalebb(i, j, p_scbb_gly)*conv_rho
            END DO
          END DO
        END DO
        IF (biomass_burn_opt .EQ. biomassb_mozc) THEN
          DO j=jts,jte
            DO k=kts,kte
              DO i=its,ite
                g_conv_rho = -(r_q*dtstep*(g_rho_phy(i, k, j)*dz8w(i, k&
&                  , j)+rho_phy(i, k, j)*g_dz8w(i, k, j))/(rho_phy(i, k, &
&                  j)*dz8w(i, k, j))**2)
                conv_rho = r_q*dtstep/(rho_phy(i, k, j)*dz8w(i, k, j))
                g_chem(i, k, j, p_oc1) = g_chem(i, k, j, p_oc1) + ebu(i&
&                  , k, j, p_ebu_oc)*(g_scalebb(i, j, p_scbb_oc)*conv_rho&
&                  +scalebb(i, j, p_scbb_oc)*g_conv_rho)
                chem(i, k, j, p_oc1) = chem(i, k, j, p_oc1) + ebu(i, k, &
&                  j, p_ebu_oc)*scalebb(i, j, p_scbb_oc)*conv_rho
                g_chem(i, k, j, p_bc1) = g_chem(i, k, j, p_bc1) + ebu(i&
&                  , k, j, p_ebu_bc)*(g_scalebb(i, j, p_scbb_bc)*conv_rho&
&                  +scalebb(i, j, p_scbb_bc)*g_conv_rho)
                chem(i, k, j, p_bc1) = chem(i, k, j, p_bc1) + ebu(i, k, &
&                  j, p_ebu_bc)*scalebb(i, j, p_scbb_bc)*conv_rho
                g_chem(i, k, j, p_p10) = g_chem(i, k, j, p_p10) + ebu(i&
&                  , k, j, p_ebu_pm10)*(g_scalebb(i, j, p_scbb_pm10)*&
&                  conv_rho+scalebb(i, j, p_scbb_pm10)*g_conv_rho)
                chem(i, k, j, p_p10) = chem(i, k, j, p_p10) + ebu(i, k, &
&                  j, p_ebu_pm10)*scalebb(i, j, p_scbb_pm10)*conv_rho
                g_chem(i, k, j, p_p25) = g_chem(i, k, j, p_p25) + ebu(i&
&                  , k, j, p_ebu_pm25)*(g_scalebb(i, j, p_scbb_pm25)*&
&                  conv_rho+scalebb(i, j, p_scbb_pm25)*g_conv_rho)
                chem(i, k, j, p_p25) = chem(i, k, j, p_p25) + ebu(i, k, &
&                  j, p_ebu_pm25)*scalebb(i, j, p_scbb_pm25)*conv_rho
              END DO
            END DO
          END DO
        END IF
      END IF
    CASE (CHEM_TRACE2) 
      DO j=jts,jte
        DO i=its,ite
          DO k=kts+1,kte-1
            g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(&
&              i, k, j)/(rho_phy(i, k, j)**2*60.))-r_q*4.828e-4*dtstep*&
&              g_dz8w(i, k, j)/(rho_phy(i, k, j)*60.))/dz8w(i, k, j)**2
            conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/60./dz8w(i, &
&              k, j)
            g_chem(i, k, j, p_tracer_1) = g_chem(i, k, j, p_tracer_1) + &
&              ebu(i, k, j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*&
&              conv_rho+scalebb(i, j, p_scbb_co)*g_conv_rho)
            chem(i, k, j, p_tracer_1) = chem(i, k, j, p_tracer_1) + ebu(&
&              i, k, j, p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
          END DO
          k = kts
          g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*dz8w(i&
&            , k, j)*60./rho_phy(i, k, j)**2)-r_q*4.828e-4*dtstep*60.*&
&            g_dz8w(i, k, j)/rho_phy(i, k, j))/(dz8w(i, k, j)*60.)**2
          conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/(dz8w(i, k, j)&
&            *60.)
          g_chem(i, k, j, p_tracer_1) = g_chem(i, k, j, p_tracer_1) + &
&            ebu(i, k, j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*conv_rho+&
&            scalebb(i, j, p_scbb_co)*g_conv_rho)
          chem(i, k, j, p_tracer_1) = chem(i, k, j, p_tracer_1) + ebu(i&
&            , k, j, p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
        END DO
      END DO
    CASE (GHG_TRACER) 
      IF (biomass_burn_opt .EQ. biomassb_ghg) THEN
        DO j=jts,jte
          DO k=kts,kte
            DO i=its,ite
              g_conv_rho = (-(dtstep*r_q*4.828e-4*g_rho_phy(i, k, j)*&
&                dz8w(i, k, j)/(rho_phy(i, k, j)**2*60.))-r_q*4.828e-4*&
&                dtstep*g_dz8w(i, k, j)/(rho_phy(i, k, j)*60.))/dz8w(i, k&
&                , j)**2
              conv_rho = r_q*4.828e-4/rho_phy(i, k, j)*dtstep/60./dz8w(i&
&                , k, j)
              g_chem(i, k, j, p_co_bbu) = g_chem(i, k, j, p_co_bbu) + &
&                ebu(i, k, j, p_ebu_co)*(g_scalebb(i, j, p_scbb_co)*&
&                conv_rho+scalebb(i, j, p_scbb_co)*g_conv_rho)
              chem(i, k, j, p_co_bbu) = chem(i, k, j, p_co_bbu) + ebu(i&
&                , k, j, p_ebu_co)*scalebb(i, j, p_scbb_co)*conv_rho
              g_chem(i, k, j, p_co2_bbu) = g_chem(i, k, j, p_co2_bbu) + &
&                ebu(i, k, j, p_ebu_co2)*(g_scalebb(i, j, p_scbb_co2)*&
&                conv_rho+scalebb(i, j, p_scbb_co2)*g_conv_rho)
              chem(i, k, j, p_co2_bbu) = chem(i, k, j, p_co2_bbu) + ebu(&
&                i, k, j, p_ebu_co2)*scalebb(i, j, p_scbb_co2)*conv_rho
              g_chem(i, k, j, p_ch4_bbu) = g_chem(i, k, j, p_ch4_bbu) + &
&                ebu(i, k, j, p_ebu_ch4)*(g_scalebb(i, j, p_scbb_ch4)*&
&                conv_rho+scalebb(i, j, p_scbb_ch4)*g_conv_rho)
              chem(i, k, j, p_ch4_bbu) = chem(i, k, j, p_ch4_bbu) + ebu(&
&                i, k, j, p_ebu_ch4)*scalebb(i, j, p_scbb_ch4)*conv_rho
            END DO
          END DO
        END DO
      END IF
    CASE DEFAULT
      CALL WRF_DEBUG(15, &
&               'nothing done with burn emissions for chem array')
    END SELECT
  END SUBROUTINE g_add_emis_burn

END MODULE g_module_add_emiss_burn
